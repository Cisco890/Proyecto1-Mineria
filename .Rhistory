knitr::opts_chunk$set(echo = TRUE)
library(haven)
install.packages('heaven')
install.packages('haven')
install.packages('purrr')
library(haven)
library(dplyr)
library(purrr)
library(stringr)
# 1) Folder where your .sav files are
ruta <- "C:/ruta/a/tu/carpeta"   # <- cambia esto
# 2) List all .sav files
archivos <- list.files(ruta, pattern = "\\.sav$", full.names = TRUE)
# 3) Read + add a "year" column inferred from filename (optional)
#    This tries to find a 4-digit year like 2019, 2020, etc.
datos_list <- map(archivos, ~{
df <- read_sav(.x)
anio <- str_extract(basename(.x), "(19|20)\\d{2}")  # e.g., "2021"
df <- df %>% mutate(year = as.integer(anio))
df
})
# 4) Bind all rows, even if columns differ across years
#    (missing columns become NA automatically)
datos_total <- bind_rows(datos_list)
# View result
glimpse(datos_total)
### Export the combined file
**To SPSS again (.sav):**
# ruta de los archivos
ruta <- "D:\Documentos_Universidad\cuarto\Primer_semestre\Mineria_datos\Proyecto 1"
# ruta de los archivos
ruta <- "D:\Documentos_Universidad\cuarto\Primer_semestre\Mineria_datos\Proyecto 1"
# ruta de los archivos
ruta <- "D:\Documentos_Universidad\cuarto\Primer_semestre\Mineria_datos\Proyecto 1"
# ruta de los archivos
ruta <- "D:/Documentos_Universidad/cuarto/Primer_semestre/Mineria_datos/Proyecto 1"
# Listar todos los archivos disponibles
archivos <- list.files(ruta, pattern = "\\.sav$", full.names = TRUE)
# Agregar el a単o basado en la metadata
datos_list <- map(archivos, ~{
df <- read_sav(.x)
anio <- str_extract(basename(.x), "(19|20)\\d{2}")  # e.g., "2021"
df <- df %>% mutate(year = as.integer(anio))
df
})
# Combinar las filas
datos_total <- bind_rows(datos_list)
# resultados
glimpse(datos_total)
# ruta de los archivos
ruta <- "D:/Documentos_Universidad/cuarto/Primer_semestre/Mineria_datos/Proyecto 1"
# Listar todos los archivos disponibles
archivos <- list.files(ruta, pattern = "\\.sav", full.names = TRUE)
# Agregar el a単o basado en la metadata
datos_list <- map(archivos, ~{
df <- read_sav(.x)
anio <- str_extract(basename(.x), "(19|20)\\d{2}")  # e.g., "2021"
df <- df %>% mutate(year = as.integer(anio))
df
})
# Combinar las filas
datos_total <- bind_rows(datos_list)
# resultados
glimpse(datos_total)
# ruta de los archivos
ruta <- "D:/Documentos_Universidad/cuarto/Primer_semestre/Mineria_datos/Proyecto 1"
# Listar todos los archivos disponibles
archivos <- list.files(ruta, pattern = "\\.SAV File", full.names = TRUE)
# Agregar el a単o basado en la metadata
datos_list <- map(archivos, ~{
df <- read_sav(.x)
anio <- str_extract(basename(.x), "(19|20)\\d{2}")  # e.g., "2021"
df <- df %>% mutate(year = as.integer(anio))
df
})
# Combinar las filas
datos_total <- bind_rows(datos_list)
# resultados
glimpse(datos_total)
library(haven)
library(dplyr)
library(purrr)
library(stringr)
# ruta de los archivos
ruta <- "D:/Documentos_Universidad/cuarto/Primer_semestre/Mineria_datos/Proyecto 1"
# Listar todos los archivos disponibles
archivos <- list.files(ruta, pattern = "\\.SAV File", full.names = TRUE)
# Agregar el a単o basado en la metadata
datos_list <- map(archivos, ~{
df <- read_sav(.x)
anio <- str_extract(basename(.x), "(19|20)\\d{2}")  # e.g., "2021"
df <- df %>% mutate(year = as.integer(anio))
df
})
# Combinar las filas
datos_total <- bind_rows(datos_list)
# resultados
glimpse(datos_total)
ruta <- "D:/Documentos_Universidad/cuarto/Primer_semestre/Mineria_datos/Proyecto 1"
# 1) Does the folder exist?
dir.exists(ruta)
# 2) What files are in there (first 30)?
list.files(ruta)[1:30]
# 3) Find .sav files
archivos <- list.files(ruta, pattern = "\\.sav$", full.names = TRUE)
length(archivos)
archivos
View(datos_total)
